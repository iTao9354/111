var dataBusinessMgr = [
	{"checked":false,"id":"0000","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0001","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0002","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0003","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0004","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0005","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0006","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0007","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"checked":false,"id":"0008","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"}
];
var dataBusinessMgr1 = [
	{"id":"0000","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0001","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0002","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0003","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0004","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0005","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0006","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0007","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0008","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0009","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0010","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0011","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0012","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0013","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0014","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0015","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0016","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0017","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0018","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0019","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0020","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0021","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0022","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0023","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0024","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0025","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"},
	{"id":"0026","name":"商机一","city":"沈阳","cusId":"9999","cusName":"吉林省高升科技有限公司","industryType":"IT","firstIndustry":"计算机信息业","secIndustry":"互联网服务业","progress":"xxx","info":"宽带业务"}
];

var treeData = {
		"total":7,
		"rows":[
		        {"id":1,"name":"All Tasks","begin":"3/4/2010","end":"3/20/2010","progress":60,"iconCls":"icon-ok"},
                {"id":2,"name":"Designing","begin":"3/4/2010","end":"3/10/2010","progress":100,"_parentId":1,"state":"closed"},
                {"id":21,"name":"Database","persons":2,"begin":"3/4/2010","end":"3/6/2010","progress":100,"_parentId":2},
                {"id":22,"name":"UML","persons":1,"begin":"3/7/2010","end":"3/8/2010","progress":100,"_parentId":2},
                {"id":23,"name":"Export Document","persons":1,"begin":"3/9/2010","end":"3/10/2010","progress":100,"_parentId":2},
                {"id":3,"name":"Coding","persons":2,"begin":"3/11/2010","end":"3/18/2010","progress":80},
                {"id":4,"name":"Testing","persons":1,"begin":"3/19/2010","end":"3/20/2010","progress":20}
         ],
         "footer":[
                {"name":"Total Persons:","persons":7,"iconCls":"icon-sum"}
         ]
};
function formatBusinessName(val,row){
	return '<span class="clicktoSeeBusiness cm-a">' +val+ '</span>'
}

function initBasicTbl1(){
	$('#basicTbl1').datagrid({
	    data:dataBusinessMgr,
	    toolbar: [
	    	{
	    		text: '<div class="datagrid-addBtn"><i class="iconfont">&#xe696;</i><span>新增</span></div>',
	    		handler: function() {
	    			alert('新增');
	    		}
	    	}
	    ],
	    columns:[[
	    	{field:'chk',width:'5%',checkbox:true},
	        {field:'id',title:'商机编号',width:'5%',sortable:true},
	        {field:'name',title:'商机名称',width:'10%',formatter:formatBusinessName},
	        {field:'city',title:'地市编码',width:'10%',sortable:true},
	        {field:'cusId',title:'客户编码',width:'10%'},
	        {field:'cusName',title:'客户名称',width:'10%'},
	        {field:'industryType',title:'行业类型',width:'10%',sortable:true},
	        {field:'firstIndustry',title:'一级行业',width:'10%'},
	        {field:'secIndustry',title:'二级行业',width:'10%'},
	        {field:'progress',title:'周计划进展及问题',width:'10%'},
	        {field:'info',title:'操作',width:'10%',align:'center',
	        	formatter : function(value, rowData, rowIndex) {
					return '<span class="iconfont" title="修改" onclick="upd('
						+ rowData.id
						+ ')";>&#xe66f;</span>'
						+ '&nbsp;<span class="iconfont icon-delBtn" onclick="del('
						+ rowData.id
						+ ');" title="删除">&#xe614;</span>'
						+ '&nbsp;'
						+ '<span class="iconfont" onclick="grant('
						+ rowData.id
						+ ')" title="设置权限">&#xe65c;</span>';					
				}
	        }
	    ]]
	});
//	formatter: function(value, row, index) {
//	    			var html = '';
//	    			html = '<div class="cm-checkbox">' +
//	    						'<label class="cm-checkbox-label">'+
//	    							'<input type="checkbox" name="funding" checked="checked">'+
//	    							'<i></i>'+
//					        	'</label>'+
//							'</div>';
//					return html;
//	    		}
	
}

//修改
function upd(id) {
	alert('修改'+id);
}
//删除
function del(id) {
	alert('删除'+id);
}
//授权
function grant(id) {
	alert('授权'+id);
}

function initBasicTbl2(){
	$('#basicTbl2').datagrid({
	    data:dataBusinessMgr,
	    columns:[[
	        {field:'id',title:'商机编号',rowspan:2,width:'5%'},
	        {field:'name',title:'商机名称',rowspan:2,width:'10%'},
	        {field:'city',title:'地市编码',rowspan:2,width:'10%'},
	        {title:'客户信息',colspan:2},
	        {field:'industryType',title:'行业类型',rowspan:2,width:'10%'},
	        {title:'行业',colspan:2},
	        {field:'progress',title:'周计划进展及问题',rowspan:2,width:'10%'},
	        {field:'info',title:'信息内容',width:'15%',rowspan:2,align:'right'}
	    ],[
	        {field:'cusId',title:'客户编码',width:'10%'},
	        {field:'cusName',title:'客户名称',width:'10%'},
	        {field:'firstIndustry',title:'一级行业',width:'10%'},
	        {field:'secIndustry',title:'二级行业',width:'10%'}
	    ]]
	});
}

var basicTbl3 = {
	init:function(){
		$('#basicTbl3').treegrid({
	//		url : webpath+'/resources/camel/js/treeData?json',
			data: treeData,    // 假数据
			idField : 'id',
			treeField : 'name',
			iconCls: 'icon-ok',
			rownumbers: true,
			animate: true,
			collapsible: true,
			fitColumns : true,// 自适应列宽
			fit : true,// 自适应宽高
			striped:true,
			columns : [ [
					{
						title : 'Task Name',
						field : 'name',
						halign : 'center',
						align : 'left',
						width : '25%'
					},
					{
						title : 'Persons',
						field : 'persons',
						halign : 'center',
						align : 'left',
						width : '25%'
					},
					{
						title : 'Begin Date',
						field : 'begin',
						halign : 'center',
						width : '25%',
						align : 'center'
	
					},
					{
						title : 'End Date',
						field : 'end',
						halign : 'center',
						align : 'center',
						width : '25%'
					} 
				] 
			]
		});
	}
};

function initBasicTbl45(){
	$('#basicTbl4').datagrid({
	    data:dataBusinessMgr1,
	    fit:true,
	    scrollbarSize:10,
	    columns:[[
	        {field:'id',title:'商机编号',width:'5%'},
	        {field:'name',title:'商机名称',width:'10%'},
	        {field:'city',title:'地市编码',width:'10%'},
	        {field:'cusId',title:'客户编码',width:'10%'},
	        {field:'cusName',title:'客户名称',width:'10%'},
	        {field:'industryType',title:'行业类型',width:'10%'},
	        {field:'firstIndustry',title:'一级行业',width:'10%'},
	        {field:'secIndustry',title:'二级行业',width:'10%'},
	        {field:'progress',title:'周计划进展及问题',width:'10%'},
	        {field:'info',title:'信息内容',width:'15%',align:'right'}
	    ]]
	});
	$('#basicTbl5').datagrid({
	    data:dataBusinessMgr,
	    frozenColumns:[[
			{field:'id',title:'商机编号',width:'5%'},
	        {field:'name',title:'商机名称',width:'20%'}
		]],
	    columns:[[
	        {field:'city',title:'地市编码',width:'20%'},
	        {field:'cusId',title:'客户编码',width:'20%'},
	        {field:'cusName',title:'客户名称',width:'20%'},
	        {field:'industryType',title:'行业类型',width:'10%'},
	        {field:'firstIndustry',title:'一级行业',width:'10%'},
	        {field:'secIndustry',title:'二级行业',width:'10%'},
	        {field:'progress',title:'周计划进展及问题',width:'10%'},
	        {field:'info',title:'信息内容',width:'15%',align:'right'}
	    ]]
	});
}

//美化滚动条
function addNiceScroll(){
	//$('body').niceScroll({cursorcolor:"#ddd",cursorwidth: "5px",cursorborder:"none"});
}

//绑定tab切换事件
function bindPanelChange(){
	$('.nav-tabs a').click(function (e) {
	  e.preventDefault();
	  $(this).tab('show');
	  var thisDom = $(this);
	  var idx = thisDom.attr('aria-controls');
	  if(idx == "childrenTable"){
	  	$('#'+idx).find('.cm-table').treegrid('resize');
	  }else{
	  	$('#'+idx).find('.cm-table').datagrid('resize');
	  }
	});
}

$(function(){
	initBasicTbl1();
	initBasicTbl2();
	basicTbl3.init();
	initBasicTbl45();
	addNiceScroll();
	bindPanelChange();
	$(window).resize(function(){
		$('#basicTbl1').datagrid('resize');
		$('#basicTbl2').datagrid('resize');
		$('#basicTbl3').treegrid('resize');
		$('#basicTbl4').datagrid('resize');
		$('#basicTbl5').datagrid('resize');
	});
});
